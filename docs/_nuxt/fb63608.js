(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{356:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},357:function(e,t,r){var content=r(373);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(75).default)("28f1127f",content,!0,{sourceMap:!1})},359:function(e,t,r){e.exports=r.p+"img/05.1325bd2.png"},360:function(e,t,r){e.exports=r.p+"img/02.079533f.png"},361:function(e,t,r){e.exports=r.p+"img/03.18d1ead.png"},362:function(e,t,r){e.exports=r.p+"img/04.f23c9f3.png"},363:function(e,t,r){e.exports=r.p+"img/06.ee61c33.png"},364:function(e,t,r){"use strict";var n=r(2),o=r(365).trim;n({target:"String",proto:!0,forced:r(366)("trim")},{trim:function(){return o(this)}})},365:function(e,t,r){var n=r(18),o="["+r(356)+"]",l=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),f=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(l,"")),2&e&&(r=r.replace(c,"")),r}};e.exports={start:f(1),end:f(2),trim:f(3)}},366:function(e,t,r){var n=r(5),o=r(356);e.exports=function(e){return n((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},367:function(e,t,r){"use strict";var n=r(2),o=r(77),l=r(20),c=r(13),f=r(5),v=r(368),d=r(160),h=r(369),_=r(370),m=r(76),S=r(371),x=[],w=x.sort,y=f((function(){x.sort(void 0)})),C=f((function(){x.sort(null)})),k=d("sort"),O=!f((function(){if(m)return m<70;if(!(h&&h>3)){if(_)return!0;if(S)return S<603;var code,e,t,r,n="";for(code=65;code<76;code++){switch(e=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(r=0;r<47;r++)x.push({k:e+r,v:t})}for(x.sort((function(a,b){return b.v-a.v})),r=0;r<x.length;r++)e=x[r].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));n({target:"Array",proto:!0,forced:y||!C||!k||!O},{sort:function(e){void 0!==e&&o(e);var t=l(this);if(O)return void 0===e?w.call(t):w.call(t,e);var r,n,f=[],d=c(t.length);for(n=0;n<d;n++)n in t&&f.push(t[n]);for(r=(f=v(f,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:String(t)>String(r)?1:-1}}(e))).length,n=0;n<r;)t[n]=f[n++];for(;n<d;)delete t[n++];return t}})},368:function(e,t){var r=Math.floor,n=function(e,t){var c=e.length,f=r(c/2);return c<8?o(e,t):l(n(e.slice(0,f),t),n(e.slice(f),t),t)},o=function(e,t){for(var element,r,n=e.length,i=1;i<n;){for(r=i,element=e[i];r&&t(e[r-1],element)>0;)e[r]=e[--r];r!==i++&&(e[r]=element)}return e},l=function(e,t,r){for(var n=e.length,o=t.length,l=0,c=0,f=[];l<n||c<o;)l<n&&c<o?f.push(r(e[l],t[c])<=0?e[l++]:t[c++]):f.push(l<n?e[l++]:t[c++]);return f};e.exports=n},369:function(e,t,r){var n=r(73).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},370:function(e,t,r){var n=r(73);e.exports=/MSIE|Trident/.test(n)},371:function(e,t,r){var n=r(73).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},372:function(e,t,r){"use strict";r(357)},373:function(e,t,r){var n=r(74)(!1);n.push([e.i,".container{margin:0 auto;min-height:100vh;display:flex;justify-content:center;align-items:center;text-align:center}.el-drawer__body span{display:block;margin:0 0 5px;background-color:#ccc}.filter-data{margin-top:20px}.filter-data h4{text-align:left}.filter-data .el-input{width:auto}.filter-data+div{display:flex}.filter-data i{cursor:pointer;font-size:18px;margin-right:3px}.filter-data>div{display:flex;justify-content:center;align-items:center}.sheet-info,.statistic{text-align:left;margin-top:20px}.wrap{background-color:#d7ecdb;border-radius:8px;box-shadow:5px 5px 5px rgba(0,0,0,.7);padding:10px}.el-dialog__wrapper{display:flex;justify-content:center;align-items:center}.el-dialog{width:auto}",""]),e.exports=n},376:function(e,t,r){"use strict";r.r(t);r(30),r(60),r(31),r(61);var n=r(23);r(38),r(231),r(62),r(80),r(364),r(78),r(79),r(46),r(232),r(367),r(39),r(45),r(233);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var c={data:function(){return{fullScreenLoading:!1,dialogVisible:!1,googleSheet:{url:"",api:"",sheetTag:"",columns:{},colCounts:0,data:[]},filters:[{col:"0",text:"",reg:!1}],drawer:{isOpen:!1,title:"",data:{}},filterData:{selectCol:""}}},mounted:function(){},computed:{filterDataAry:function(){return this.filters.reduce((function(e,filter){return e.filter((function(e){return filter.reg?new RegExp(filter.text.trim()).test(e[filter.col]):e[filter.col].includes(filter.text)}))}),this.googleSheet.data)},dataStatistics:function(){var e=this;return this.filterDataAry.reduce((function(t,r){return r[e.filterData.selectCol].split("||").map((function(e){e=e.trim().toLocaleUpperCase(),t[e]?t[e]+=1:t[e]=1})),t}),{})},dataStatisticsKeysAry:function(){return Object.keys(this.dataStatistics).sort((function(a,b){return a.length-b.length}))},drawerDataKeysAry:function(){return Object.keys(this.drawer.data).sort((function(a,b){return a.length-b.length}))}},methods:{getGoogleSheetData:function(){var e=this;this.fullScreenLoading=!0;var t={sheetUrl:this.googleSheet.url,sheetTag:this.googleSheet.sheetTag,row:1,col:1,endRow:1,endCol:1e3};this.alertMessage("開始取得欄位數量","info"),$.get(this.googleSheet.api,t,(function(data){e.googleSheet.colCounts=data.split(",").length})).done((function(){e.alertMessage("共 ".concat(e.googleSheet.colCounts," 欄"),"success"),t.endRow=1e3,$.get(e.googleSheet.api,t,(function(data){for(var t=data.split(","),r=e.googleSheet.colCounts,o=t.length/r,c=[],i=0;i<o;i++){var f=t.slice(73*i,73*(i+1)).reduce((function(e,t,r){return l(l({},e),{},Object(n.a)({},r,t))}),{});c.push(f)}e.googleSheet.columns=c[0],e.googleSheet.data=c.slice(1),e.alertMessage("共 ".concat(e.googleSheet.data.length," 筆"),"success"),e.fullScreenLoading=!1})).fail((function(){e.alertMessage("取得資料失敗","error"),e.fullScreenLoading=!1}))})).fail((function(){e.alertMessage("取得資料失敗","error"),e.fullScreenLoading=!1}))},checkFilterData:function(filter){var e=this.googleSheet.data.filter((function(e){return filter.reg?new RegExp(filter.text.trim().toLocaleUpperCase()).test(e[filter.col]):e[filter.col].includes(filter.text.trim().toLocaleUpperCase())})).reduce((function(e,t){return t[filter.col].split("||").map((function(t){t=t.trim().toLocaleUpperCase(),e[t]?e[t]+=1:e[t]=1})),e}),{});this.drawer.isOpen=!0,this.drawer.title=this.googleSheet.columns[filter.col],this.drawer.data=e},addFilter:function(){this.filters.push({col:"0",text:"",reg:!1})},delFilter:function(e){this.filters.splice(e,1)},alertMessage:function(e,t){this.$message({message:e,type:t})}}},f=(r(372),r(58)),component=Object(f.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullScreenLoading,expression:"fullScreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":"取得資料中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.6)"}}),e._v(" "),n("div",[n("h1",[e._v("Google Sheet Analysis")]),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-link",{attrs:{type:"primary"},nativeOn:{click:function(t){e.dialogVisible=!0}}},[e._v("使用說明")])],1),e._v(" "),n("el-drawer",{attrs:{title:"使用說明",visible:e.dialogVisible,size:"75%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",[n("ul",{staticStyle:{"text-align":"left"}},[n("li",[n("p",[e._v("\n              需修改原始資料分隔符號，建議保留原始檔案，複製一份新試算表再行操作\n            ")]),e._v(" "),n("ol",[n("li",[n("p",[e._v("打開試算表，點選[編輯]>[尋找與取代]")])]),e._v(" "),n("li",[n("p",[e._v("\n                  尋找[,]全部取代為[||]，原始資料欄位或選項不可使用[,]避免錯誤\n                ")]),e._v(" "),n("img",{attrs:{src:r(359)}})])])]),e._v(" "),n("li",[n("p",[e._v("URL: 設定權限如下圖後，複製連結")]),e._v(" "),n("img",{attrs:{src:r(360)}})]),e._v(" "),n("li",[n("p",[e._v("API: 依以下步驟取得")]),e._v(" "),n("ol",[n("li",[n("p",[e._v("點選[工具]>[指令碼編輯器]")]),e._v(" "),n("img",{attrs:{src:r(361)}})]),e._v(" "),n("li",[n("p",[e._v("複製以下程式碼貼上")]),e._v(" "),n("p",[e._v("\n                  function doGet(e) {"),n("br"),e._v("\n                  var params = e.parameter;"),n("br"),e._v("\n                  var sheetUrl = params.sheetUrl;"),n("br"),e._v("\n                  var sheetTag = params.sheetTag;"),n("br"),e._v("\n                  var row = params.row;"),n("br"),e._v("\n                  var col = params.col;"),n("br"),e._v("\n                  var endRow = params.endRow;"),n("br"),e._v("\n                  var endCol = params.endCol;"),n("br"),e._v("\n                  var rowRange = endRow - row + 1;"),n("br"),e._v("\n                  var colRange = endCol - col + 1;"),n("br"),e._v("\n\n                  var SpreadSheet = SpreadsheetApp.openByUrl(sheetUrl);"),n("br"),e._v("\n                  var Sheet = SpreadSheet.getSheetByName(sheetTag);"),n("br"),e._v("\n\n                  var lastRow = Sheet.getLastRow();"),n("br"),e._v("\n                  var lastCol = Sheet.getLastColumn();"),n("br"),e._v("\n\n                  if(rowRange>lastRow){"),n("br"),e._v("\n                  rowRange = lastRow;"),n("br"),e._v("\n                  }"),n("br"),e._v("\n\n                  if(colRange>lastCol){"),n("br"),e._v("\n                  colRange = lastCol;"),n("br"),e._v("\n                  }"),n("br"),e._v("\n\n                  var data = Sheet.getSheetValues(row, col,\n                  rowRange,colRange);"),n("br"),e._v("\n\n                  return ContentService.createTextOutput(data);"),n("br"),e._v("\n                  }\n                ")])]),e._v(" "),n("li",[n("p",[e._v("\n                  點選[部署]>[新增部署作業]，點選[部署]按鈕，即可取得網頁應用程式網址（API網址）\n                ")]),e._v(" "),n("img",{attrs:{src:r(362)}})])])]),e._v(" "),n("li",[n("p",[e._v("工作表名稱: 試算表下方分頁名稱")]),e._v(" "),n("img",{attrs:{src:r(363)}})])])]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})]),e._v(" "),n("div",{staticClass:"wrap"},[n("el-form",{attrs:{"label-position":"right","label-width":"100px",model:e.googleSheet}},[n("el-form-item",{attrs:{label:"URL : "}},[n("el-input",{model:{value:e.googleSheet.url,callback:function(t){e.$set(e.googleSheet,"url",t)},expression:"googleSheet.url"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"API : "}},[n("el-input",{model:{value:e.googleSheet.api,callback:function(t){e.$set(e.googleSheet,"api",t)},expression:"googleSheet.api"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"工作表名稱 : "}},[n("el-input",{model:{value:e.googleSheet.sheetTag,callback:function(t){e.$set(e.googleSheet,"sheetTag",t)},expression:"googleSheet.sheetTag"}})],1),e._v(" "),n("el-button",{nativeOn:{click:function(t){return e.getGoogleSheetData()}}},[e._v("取得資料")])],1)],1),e._v(" "),e.googleSheet.colCounts?n("div",{staticClass:"sheet-info wrap"},[n("h4",[e._v("Google Sheet資訊")]),e._v(" "),n("div",[e._v("欄位："+e._s(e.googleSheet.colCounts))]),e._v(" "),n("div",[e._v("資料筆數："+e._s(e.googleSheet.data.length))])]):e._e(),e._v(" "),e.googleSheet.data.length?n("div",{staticClass:"filter-data wrap"},[n("h4",[e._v("\n        篩選資料\n        "),n("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(t){return e.addFilter()}}})]),e._v(" "),e._l(e.filters,(function(filter,t){return n("div",{key:t},[n("i",{staticClass:"el-icon-circle-close",on:{click:function(r){return e.delFilter(t)}}}),e._v(" "),n("el-select",{attrs:{placeholder:"請選擇"},model:{value:filter.col,callback:function(t){e.$set(filter,"col",t)},expression:"filter.col"}},e._l(e.googleSheet.columns,(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})})),1),e._v(" "),n("el-input",{attrs:{type:"text",placeholder:"輸入篩選條件"},model:{value:filter.text,callback:function(t){e.$set(filter,"text",t)},expression:"filter.text"}}),e._v(" "),n("el-button",{nativeOn:{click:function(t){return e.checkFilterData(filter)}}},[e._v("檢視")]),e._v(" "),n("el-checkbox",{model:{value:filter.reg,callback:function(t){e.$set(filter,"reg",t)},expression:"filter.reg"}},[e._v("正規表示")])],1)}))],2):e._e(),e._v(" "),n("el-drawer",{attrs:{title:e.drawer.title,visible:e.drawer.isOpen,size:"50%"},on:{"update:visible":function(t){return e.$set(e.drawer,"isOpen",t)}}},[n("div",e._l(e.drawerDataKeysAry,(function(t){return n("span",{key:t},[e._v(e._s(t)+" : "+e._s(e.drawer.data[t]))])})),0)]),e._v(" "),e.googleSheet.data.length?n("div",{staticClass:"statistic wrap"},[n("div",[n("span",[e._v("共"+e._s(e.filterDataAry.length)+"筆，")]),e._v(" "),n("el-select",{attrs:{placeholder:"請選擇"},model:{value:e.filterData.selectCol,callback:function(t){e.$set(e.filterData,"selectCol",t)},expression:"filterData.selectCol"}},e._l(e.googleSheet.columns,(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),e._v(" "),e.filterData.selectCol?n("div",[n("dl",[n("dt",[e._v(e._s(e.googleSheet.columns[e.filterData.selectCol]))]),e._v(" "),e._l(e.dataStatisticsKeysAry,(function(t){return n("dd",{key:t},[e._v("\n            "+e._s(t)+" : "+e._s(e.dataStatistics[t])+"\n          ")])}))],2)]):e._e()]):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports}}]);