(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{356:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},357:function(e,t,r){var content=r(368);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(75).default)("28f1127f",content,!0,{sourceMap:!1})},359:function(e,t,r){"use strict";var n=r(2),o=r(360).trim;n({target:"String",proto:!0,forced:r(361)("trim")},{trim:function(){return o(this)}})},360:function(e,t,r){var n=r(18),o="["+r(356)+"]",l=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),f=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(l,"")),2&e&&(r=r.replace(c,"")),r}};e.exports={start:f(1),end:f(2),trim:f(3)}},361:function(e,t,r){var n=r(5),o=r(356);e.exports=function(e){return n((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},362:function(e,t,r){"use strict";var n=r(2),o=r(77),l=r(20),c=r(13),f=r(5),h=r(363),d=r(160),v=r(364),m=r(365),x=r(76),S=r(366),_=[],w=_.sort,y=f((function(){_.sort(void 0)})),O=f((function(){_.sort(null)})),k=d("sort"),j=!f((function(){if(x)return x<70;if(!(v&&v>3)){if(m)return!0;if(S)return S<603;var code,e,t,r,n="";for(code=65;code<76;code++){switch(e=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(r=0;r<47;r++)_.push({k:e+r,v:t})}for(_.sort((function(a,b){return b.v-a.v})),r=0;r<_.length;r++)e=_[r].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));n({target:"Array",proto:!0,forced:y||!O||!k||!j},{sort:function(e){void 0!==e&&o(e);var t=l(this);if(j)return void 0===e?w.call(t):w.call(t,e);var r,n,f=[],d=c(t.length);for(n=0;n<d;n++)n in t&&f.push(t[n]);for(r=(f=h(f,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:String(t)>String(r)?1:-1}}(e))).length,n=0;n<r;)t[n]=f[n++];for(;n<d;)delete t[n++];return t}})},363:function(e,t){var r=Math.floor,n=function(e,t){var c=e.length,f=r(c/2);return c<8?o(e,t):l(n(e.slice(0,f),t),n(e.slice(f),t),t)},o=function(e,t){for(var element,r,n=e.length,i=1;i<n;){for(r=i,element=e[i];r&&t(e[r-1],element)>0;)e[r]=e[--r];r!==i++&&(e[r]=element)}return e},l=function(e,t,r){for(var n=e.length,o=t.length,l=0,c=0,f=[];l<n||c<o;)l<n&&c<o?f.push(r(e[l],t[c])<=0?e[l++]:t[c++]):f.push(l<n?e[l++]:t[c++]);return f};e.exports=n},364:function(e,t,r){var n=r(73).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},365:function(e,t,r){var n=r(73);e.exports=/MSIE|Trident/.test(n)},366:function(e,t,r){var n=r(73).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},367:function(e,t,r){"use strict";r(357)},368:function(e,t,r){var n=r(74)(!1);n.push([e.i,".container{margin:0 auto;min-height:100vh;display:flex;justify-content:center;align-items:center;text-align:center}.el-drawer__body span{display:block;margin:0 5px 4px 0;padding:2px;background-color:#ccc}",""]),e.exports=n},371:function(e,t,r){"use strict";r.r(t);r(30),r(60),r(31),r(61);var n=r(23);r(38),r(231),r(62),r(80),r(359),r(78),r(79),r(362),r(39),r(232),r(11),r(45),r(46);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var c={data:function(){return{googleSheet:{url:"",api:"",columns:{},colCounts:0,data:[]},value:"0",num:"0",filter:"",filters:[{col:"2",text:"女",reg:!1},{col:"4",text:"化學",reg:!0}],drawer:{isOpen:!1,title:"",data:{}}}},computed:{statistics:function(){return this.filters.reduce((function(e,filter){return e.filter((function(e){return filter.reg?new RegExp(filter.text.trim()).test(e[filter.col]):e[filter.col].includes(filter.text)}))}),this.googleSheet.data).length},drawerDataKeysAry:function(){return Object.keys(this.drawer.data).sort((function(a,b){return a.length-b.length}))}},methods:{getGoogleSheetData:function(){var e=this,t={sheetUrl:this.googleSheet.url,sheetTag:"工作表1",row:1,col:1,endRow:1,endCol:1e3};this.$axios.get(this.googleSheet.api,{params:t}).then((function(t){return e.googleSheet.colCounts=t.data.split(",").length,Promise.resolve(e.colCounts)})).then((function(){t.endRow=1e3,e.$axios.get(e.googleSheet.api,{params:t}).then((function(t){for(var r=t.data.split(","),o=e.googleSheet.colCounts,c=r.length/o,f=[],i=0;i<c;i++){var h=r.slice(73*i,73*(i+1)).reduce((function(e,t,r){return l(l({},e),{},Object(n.a)({},r,t))}),{});f.push(h)}e.googleSheet.columns=f[0],e.googleSheet.data=f.slice(1)}))}))},checkFilterData:function(filter){var e=this.googleSheet.data.filter((function(e){return filter.reg?new RegExp(filter.text.trim()).test(e[filter.col]):e[filter.col].includes(filter.text)})).reduce((function(e,t){return t[filter.col].split("||").map((function(t){t=t.trim(),e[t]?e[t]+=1:e[t]=1})),e}),{});this.drawer.isOpen=!0,this.drawer.title=this.googleSheet.columns[filter.col],this.drawer.data=e}}},f=(r(367),r(58)),component=Object(f.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",[r("h1",[e._v("Google Sheet Analysis")]),e._v(" "),r("div",[r("el-form",{attrs:{"label-position":"left","label-width":"80px",model:e.googleSheet}},[r("el-form-item",{attrs:{label:"URL"}},[r("el-input",{model:{value:e.googleSheet.url,callback:function(t){e.$set(e.googleSheet,"url",t)},expression:"googleSheet.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"API"}},[r("el-input",{model:{value:e.googleSheet.api,callback:function(t){e.$set(e.googleSheet,"api",t)},expression:"googleSheet.api"}})],1)],1)],1),e._v(" "),r("input",{attrs:{type:"button",value:"取得資料"},on:{click:function(t){return e.getGoogleSheetData()}}}),e._v(" "),e.googleSheet.colCounts?r("div",[r("div",[e._v("欄位："+e._s(e.googleSheet.colCounts))]),e._v(" "),r("div",[e._v("資料筆數："+e._s(e.googleSheet.data.length))])]):e._e(),e._v(" "),e.googleSheet.colCounts?r("div",e._l(e.filters,(function(filter,t){return r("div",{key:t,staticStyle:{display:"flex"}},[r("el-select",{attrs:{placeholder:"请選擇"},model:{value:filter.col,callback:function(t){e.$set(filter,"col",t)},expression:"filter.col"}},e._l(e.googleSheet.columns,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:t}})})),1),e._v(" "),r("el-input",{attrs:{type:"text"},model:{value:filter.text,callback:function(t){e.$set(filter,"text",t)},expression:"filter.text"}}),e._v(" "),r("el-button",{nativeOn:{click:function(t){return e.checkFilterData(filter)}}},[e._v("確認資料")]),e._v(" "),r("el-checkbox",{model:{value:filter.reg,callback:function(t){e.$set(filter,"reg",t)},expression:"filter.reg"}},[e._v("正規表示")])],1)})),0):e._e(),e._v(" "),r("el-drawer",{attrs:{title:e.drawer.title,visible:e.drawer.isOpen},on:{"update:visible":function(t){return e.$set(e.drawer,"isOpen",t)}}},[r("div",e._l(e.drawerDataKeysAry,(function(t){return r("span",{key:t},[e._v(e._s(t)+" : "+e._s(e.drawer.data[t]))])})),0)]),e._v(" "),e.googleSheet.data.length?r("p",[e._v("共"+e._s(e.statistics)+"筆")]):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports}}]);