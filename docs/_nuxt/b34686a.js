(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{356:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},357:function(t,e,r){var content=r(368);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(75).default)("28f1127f",content,!0,{sourceMap:!1})},359:function(t,e,r){"use strict";var n=r(2),o=r(360).trim;n({target:"String",proto:!0,forced:r(361)("trim")},{trim:function(){return o(this)}})},360:function(t,e,r){var n=r(18),o="["+r(356)+"]",l=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),f=function(t){return function(e){var r=String(n(e));return 1&t&&(r=r.replace(l,"")),2&t&&(r=r.replace(c,"")),r}};t.exports={start:f(1),end:f(2),trim:f(3)}},361:function(t,e,r){var n=r(5),o=r(356);t.exports=function(t){return n((function(){return!!o[t]()||"​᠎"!="​᠎"[t]()||o[t].name!==t}))}},362:function(t,e,r){"use strict";var n=r(2),o=r(77),l=r(20),c=r(13),f=r(5),d=r(363),h=r(160),v=r(364),_=r(365),m=r(76),S=r(366),x=[],y=x.sort,w=f((function(){x.sort(void 0)})),k=f((function(){x.sort(null)})),O=h("sort"),C=!f((function(){if(m)return m<70;if(!(v&&v>3)){if(_)return!0;if(S)return S<603;var code,t,e,r,n="";for(code=65;code<76;code++){switch(t=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(r=0;r<47;r++)x.push({k:t+r,v:e})}for(x.sort((function(a,b){return b.v-a.v})),r=0;r<x.length;r++)t=x[r].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n}}));n({target:"Array",proto:!0,forced:w||!k||!O||!C},{sort:function(t){void 0!==t&&o(t);var e=l(this);if(C)return void 0===t?y.call(e):y.call(e,t);var r,n,f=[],h=c(e.length);for(n=0;n<h;n++)n in e&&f.push(e[n]);for(r=(f=d(f,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:String(e)>String(r)?1:-1}}(t))).length,n=0;n<r;)e[n]=f[n++];for(;n<h;)delete e[n++];return e}})},363:function(t,e){var r=Math.floor,n=function(t,e){var c=t.length,f=r(c/2);return c<8?o(t,e):l(n(t.slice(0,f),e),n(t.slice(f),e),e)},o=function(t,e){for(var element,r,n=t.length,i=1;i<n;){for(r=i,element=t[i];r&&e(t[r-1],element)>0;)t[r]=t[--r];r!==i++&&(t[r]=element)}return t},l=function(t,e,r){for(var n=t.length,o=e.length,l=0,c=0,f=[];l<n||c<o;)l<n&&c<o?f.push(r(t[l],e[c])<=0?t[l++]:e[c++]):f.push(l<n?t[l++]:e[c++]);return f};t.exports=n},364:function(t,e,r){var n=r(73).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},365:function(t,e,r){var n=r(73);t.exports=/MSIE|Trident/.test(n)},366:function(t,e,r){var n=r(73).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},367:function(t,e,r){"use strict";r(357)},368:function(t,e,r){var n=r(74)(!1);n.push([t.i,".container{margin:0 auto;min-height:100vh;display:flex;justify-content:center;align-items:center;text-align:center}.el-drawer__body span{display:block;margin:0 0 5px;background-color:#ccc}.filter-data h4{text-align:left}.filter-data .el-input{width:auto}.filter-data+div{display:flex}.filter-data i{cursor:pointer;font-size:18px}.sheet-info,.statistic{text-align:left}",""]),t.exports=n},371:function(t,e,r){"use strict";r.r(e);r(30),r(60),r(31),r(61);var n=r(23);r(38),r(231),r(62),r(80),r(359),r(78),r(79),r(46),r(232),r(362),r(39),r(11),r(45),r(233);function o(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var c={data:function(){return{googleSheet:{url:"",api:"",columns:{},colCounts:0,data:[]},filters:[{col:"0",text:"",reg:!1}],drawer:{isOpen:!1,title:"",data:{}},filterData:{selectCol:""}}},mounted:function(){},computed:{filterDataAry:function(){return this.filters.reduce((function(t,filter){return t.filter((function(t){return filter.reg?new RegExp(filter.text.trim()).test(t[filter.col]):t[filter.col].includes(filter.text)}))}),this.googleSheet.data)},dataStatistics:function(){var t=this;return this.filterDataAry.reduce((function(e,r){return r[t.filterData.selectCol].split("||").map((function(t){t=t.trim().toLocaleUpperCase(),e[t]?e[t]+=1:e[t]=1})),e}),{})},dataStatisticsKeysAry:function(){return Object.keys(this.dataStatistics).sort((function(a,b){return a.length-b.length}))},drawerDataKeysAry:function(){return Object.keys(this.drawer.data).sort((function(a,b){return a.length-b.length}))}},methods:{getGoogleSheetData:function(){var t=this,e={sheetUrl:this.googleSheet.url,sheetTag:"工作表1",row:1,col:1,endRow:1,endCol:1e3};this.$axios.get(this.googleSheet.api,{params:e}).then((function(e){return t.googleSheet.colCounts=e.data.split(",").length,Promise.resolve(t.colCounts)})).then((function(){e.endRow=1e3,t.$axios.get(t.googleSheet.api,{params:e}).then((function(e){for(var r=e.data.split(","),o=t.googleSheet.colCounts,c=r.length/o,f=[],i=0;i<c;i++){var d=r.slice(73*i,73*(i+1)).reduce((function(t,e,r){return l(l({},t),{},Object(n.a)({},r,e))}),{});f.push(d)}t.googleSheet.columns=f[0],t.googleSheet.data=f.slice(1)}))}))},checkFilterData:function(filter){var t=this.googleSheet.data.filter((function(t){return filter.reg?new RegExp(filter.text.trim().toLocaleUpperCase()).test(t[filter.col]):t[filter.col].includes(filter.text.trim().toLocaleUpperCase())})).reduce((function(t,e){return e[filter.col].split("||").map((function(e){e=e.trim().toLocaleUpperCase(),t[e]?t[e]+=1:t[e]=1})),t}),{});this.drawer.isOpen=!0,this.drawer.title=this.googleSheet.columns[filter.col],this.drawer.data=t},addFilter:function(){this.filters.push({col:"0",text:"",reg:!1})},delFilter:function(t){this.filters.splice(t,1)}}},f=(r(367),r(58)),component=Object(f.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",[r("h1",[t._v("Google Sheet Analysis")]),t._v(" "),r("div",[r("el-form",{attrs:{"label-position":"left","label-width":"80px",model:t.googleSheet}},[r("el-form-item",{attrs:{label:"URL"}},[r("el-input",{model:{value:t.googleSheet.url,callback:function(e){t.$set(t.googleSheet,"url",e)},expression:"googleSheet.url"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"API"}},[r("el-input",{model:{value:t.googleSheet.api,callback:function(e){t.$set(t.googleSheet,"api",e)},expression:"googleSheet.api"}})],1),t._v(" "),r("el-form-item",[r("el-button",{nativeOn:{click:function(e){return t.getGoogleSheetData()}}},[t._v("取得資料")])],1)],1)],1),t._v(" "),t.googleSheet.colCounts?r("div",{staticClass:"sheet-info"},[r("h4",[t._v("Google Sheet資訊")]),t._v(" "),r("div",[t._v("欄位："+t._s(t.googleSheet.colCounts))]),t._v(" "),r("div",[t._v("資料筆數："+t._s(t.googleSheet.data.length))])]):t._e(),t._v(" "),t.googleSheet.data.length?r("div",{staticClass:"filter-data"},[r("h4",[t._v("\n        篩選資料\n        "),r("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(e){return t.addFilter()}}})]),t._v(" "),t._l(t.filters,(function(filter,e){return r("div",{key:e},[r("i",{staticClass:"el-icon-circle-close",on:{click:function(r){return t.delFilter(e)}}}),t._v(" "),r("el-select",{attrs:{placeholder:"請選擇"},model:{value:filter.col,callback:function(e){t.$set(filter,"col",e)},expression:"filter.col"}},t._l(t.googleSheet.columns,(function(t,e){return r("el-option",{key:e,attrs:{label:t,value:e}})})),1),t._v(" "),r("el-input",{attrs:{type:"text",placeholder:"輸入篩選條件"},model:{value:filter.text,callback:function(e){t.$set(filter,"text",e)},expression:"filter.text"}}),t._v(" "),r("el-button",{nativeOn:{click:function(e){return t.checkFilterData(filter)}}},[t._v("確認資料")]),t._v(" "),r("el-checkbox",{model:{value:filter.reg,callback:function(e){t.$set(filter,"reg",e)},expression:"filter.reg"}},[t._v("正規表示")])],1)}))],2):t._e(),t._v(" "),r("el-drawer",{attrs:{title:t.drawer.title,visible:t.drawer.isOpen},on:{"update:visible":function(e){return t.$set(t.drawer,"isOpen",e)}}},[r("div",t._l(t.drawerDataKeysAry,(function(e){return r("span",{key:e},[t._v(t._s(e)+" : "+t._s(t.drawer.data[e]))])})),0)]),t._v(" "),t.googleSheet.data.length?r("div",{staticClass:"statistic"},[r("el-divider"),t._v(" "),r("div",[r("span",[t._v("共"+t._s(t.filterDataAry.length)+"筆，")]),t._v(" "),r("el-select",{attrs:{placeholder:"請選擇"},model:{value:t.filterData.selectCol,callback:function(e){t.$set(t.filterData,"selectCol",e)},expression:"filterData.selectCol"}},t._l(t.googleSheet.columns,(function(t,e){return r("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),t._v(" "),t.filterData.selectCol?r("div",[r("dl",[r("dt",[t._v(t._s(t.googleSheet.columns[t.filterData.selectCol]))]),t._v(" "),t._l(t.dataStatisticsKeysAry,(function(e){return r("dd",{key:e},[t._v("\n            "+t._s(e)+" : "+t._s(t.dataStatistics[e])+"\n          ")])}))],2)]):t._e()],1):t._e()],1)])}),[],!1,null,null,null);e.default=component.exports}}]);